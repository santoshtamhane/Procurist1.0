<!--
  Generated template for the SearchResultPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header> 
 <ion-navbar color='tertiary'>
<button ion-button icon-only menuToggle>
      <ion-icon name="menu"></ion-icon> 
    </button>

    <ion-title>Search Result</ion-title>

<ion-buttons end>
      <button ion-button icon-only (click)="goHome()">
        <ion-icon name="home"></ion-icon>
        </button>
    </ion-buttons> 
    </ion-navbar>
</ion-header>


<ion-content >
<h2>{{Category}}-{{Product}}</h2>
<h2><ion-item>
               <ion-label  stacked ><ion-icon name="pin" color=map-get($colors:primary)></ion-icon> Location</ion-label>
                    <ion-select [(ngModel)]="locn" placeholder="All" (ionChange)="filterLocn(locn)">
                    <ion-option>All</ion-option>
                    <ion-option *ngFor="let location of Locations|async">{{location.City}}</ion-option>
                    </ion-select>
                   
 </ion-item></h2>
  <!--<ion-list style="background-color:#c4d5e6;">
  
  <ion-item >-->
  <h3> {{(searches|async)?.length}} results found </h3>
  <ion-card *ngFor="let srch of searches|async let i=index" #elem [attr.id]="i+1">
  <ion-card-header>
     <h1 style="color:#fff">{{elem.id}}.{{ srch.Orgn }}</h1>
     </ion-card-header>
     <ion-card-content>
     <ion-grid>
     <ion-row>
     <ion-col >
     <p style="color:#a1d6e2">Contact Person</p><h2 style="color:#ffb745">{{srch.Supplier}} </h2>
    <p style="color:#a1d6e2">Location</p><h2 style="color:#ffb745">{{srch.City}}</h2>
     </ion-col>
     <ion-col >
  <p style="color:#a1d6e2"> Average Rating</p>
  <h1 style="color:#fff;font-size:500%;align:center">{{getAvgRating(srch.Orgn,1)}}{{trxnval}}</h1>
  <h4 style="color:#fff ;font-size:75%;align:left"> from {{contributorcount}} contributors</h4>
     </ion-col>
     </ion-row>
     </ion-grid>
     
    <ion-row>
    <ion-col col-5>
    <button ion-button clear style="color:secondary" (click)="getAllComments(srch.Orgn,i)" *ngIf="elem.id!=viewindex+1">View Comments</button>
    <button ion-button clear style="color:secondary" (click)="closeAllComments()" *ngIf="elem.id==viewindex+1">Close Comments</button>
        </ion-col>
    <ion-col col-5>
   <button ion-button clear style="color:secondary" (click)="rate(srch.Orgn,srch.MainProduct,srch.Category)">Rate Supplier</button>
        </ion-col>
    <ion-col col-2>
   <button ion-button icon-only  color="dark" (click)="showModal(srch.Orgn,srch.Phone,srch.Supplier)">
  <ion-icon name="ios-more" color="light"></ion-icon>
</button>
        </ion-col>
    </ion-row> 
    <ion-row>
    
    <ion-list *ngIf="elem.id==viewindex+1">
    
        <ion-item *ngFor= "let comm of AllComments|async let commindex=index">
        <p>{{commindex+1}}.
        {{comm.Comments}}</p>
        </ion-item>
        
    </ion-list>
    </ion-row>
    </ion-card-content>
    </ion-card>

  
</ion-content>
